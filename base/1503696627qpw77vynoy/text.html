<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html><head><meta name="qrichtext" content="1" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><style type="text/css">
p, li { white-space: pre-wrap; }
</style></head><body style=" font-family:'DejaVu Sans'; font-size:11pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Презентация - https://www.ptsecurity.com/upload/corporate/ru-ru/webinars/ics/webinar_7-08-2014.pdf<br /><br />ggsm - gps-шлюз, который выпускает мобильный телефон в интернет. (Предоставляет доступ к Интернету + Сотовой связи + сторонним организациям)<br />Протоколы, которые поддерживает ggsm - snmp, telnet, ftp, http </p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">ss7 (общеканальные системы сигнализации №7) - используется для управления телефонными вызовами. Объединяет всех телефонных операторов мобильной связи.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для возможности передачи информации по IP-каналам был разработан SIGTRAN. Он связывает сети прошлых поколений с будущими.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">С приходом конвергентных сетей получить доступ к сигнальной сети стало гораздо проще.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Компоненты в телефонной сети (Из чего состоит сеть мобильного оператора):</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">1) Радио-часть (наземная сеть базовых станций, контроллеры, мобильные телефоны) {не являются частью сети ss7}</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">2) MSC VLR (Mobile Switching Center; Visitor Location Reegister) - центр мобильной коммутации (кратко: коммутатор обрабатывающий вызовы). И при нём VLR (Временная база данных абонентов, которые сейчас находятся в зоне действия этого определлённого коммутатора)<br />3) Gateway MSC (Gateway Mobile Switching Center) - пограничный коммутатор. Нужен для обработки входящих вызовов. На него приходит звонок и он начинает искать, где находится абонент.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">4) SMS-C (Short Message Service Center)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">5) HLR (Homey Location Register) - это база данных, которая хранит в себе информацию обо всех мобильных абонентов операторов.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">6) Billing или Billing'овая платформа - система, которая считает деньги.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Для того, что идентифицировать мобильного оператора используется:<br />1) GT (Global Title) - идентификатор (какого-то) узла в сети. Телефон таковым узлом не является.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">2) MSISDN - фактический телефонный номер абонента</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">3) MSRN (Mobile Subscriber Roaming Number) - роуминговый номер мобильного абонента. Он идентичен обычному телефонному номеру и является временным идентификатором трубки, который используется исключительно на момент соединения коммутации звонка.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">4) IMSI (International Mobile Subscriber Identity) - международный идентификатор абонента. Иногда его ещё называют номером сим-карты.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Телефонная связь не изолирована от внешнего мира, она окружена другими сетями и активно с ними работает и поэтому попасть в сеть сигнализации можно при помощи:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">1) Корневые сети. Сети для обработки корневого трафика. (PSCore, IMS)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">2) Различные сети доступа, к которым подключается абонент. (LTE, Wi-Fi, WiMAX, PON, DSL)</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">3) Сети обмена GPRS-трафиком (GRX, IPX)<br />4) Сети, с которых осуществляется управление и техническая поддержка (OAM; Remote control) всей инфраструктуры</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">5) IT networks для бухгалтерии, маркетинга...</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">6) Internet</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Определение местоположения:<br />1) Выбирается телефонный номер жертвы.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">2) Имея подключение к сигнальной сети, собирал информацию о сети оператора, в которой находился абонент-жертва. А именно о коммутаторе и VLR, который на данный момент обслуживали абонента. {Для получения информации о коммутаторе посылается запрос sendRoutingInfoForSM, указывая в качестве получателя номер телефона. Gateway MSC, на который приходит данный запрос, о не обладает информацией, которую запрашиет атакующий. А атакующий в этом случае представляется СМС-центром. Будто жертве кто-то хочет отправить смс. И дабы отправить СМС СМС-центру нужно выяснить, где находится абонент, где чего и делается этот запрос. Gateway MSC, не обладая информацей перенаправляет запрос HLR'у, который обрабатывает этот запрос и отвечает Gateway MSC(пограничному коммутатору) следующее: а) Я HLR с таким-то Global Title'ом. б) твой абонент зарегистрирован на MSC VLR таком-то, сообщает его Global Title. в) IMSI абонента. Пограничный коммутатор сообщает данную информацию нам.}</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">3) Далее через запрос-информацию об абоненте можно получить идентификатор сотового, в которой находился телефон. {Посылаем запрос provideSubscriberInfo на MSC VLR и представимся HLR'ом, указывая его Global Title. Тем самым просим нам сказать, ге находится абонент-жертва. После чего возвращаются Mobile Country Code, Mobile Network Code, Locall Area Code и самое главное Cell ID - то, что мы хотели узнать. Это идентификатор базовой станции, которая на данный момент обслуживает абонента.}</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">4) Имея этот идентификатор производится поиск на карте. {Сервисы для gsm-сигнализации позволяют по Cell ID найти точку на карте, где находится базовая станция.}</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Прослушка переговоров:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Можно осуществить при помощи перенаправления вызова в сигнальной сети. Т.е. маршрутизирует вызов на своё оборудование.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">1) Выбирается телефонный номер жертвы.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">2) Собираем информацию об операторе. {Отправляется sendRoutingInfoForSM как при нахождении местоположения жертвы}</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">3) Посылаем запрос provideSubscriberData на MSC VLR и представимся HLR'ом, в котором указывается, что для абонента сменился адрес billing'овой платформы и, в качестве billing'овой платформы, злоумышленник указывает себя.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">0) Это означает, что когда абонент А решат позвонить жертве, то запрос этого вызова обработает его домашний коммутатор. Коммутатор, в свою очередь, должен обратиться к billing'овой платформе, чтоб начать верификацию. Но этот запрос уходит злоуышленнику, который отвечает, что разрешает подключение и отсылает номер, куда следует маршрутизировать вызов. После чего маршрутизатор переводит звонок на номер, который был послан billing'овой системой. После этого злоумышленник может пообщаться с абонентом А. На этой стадии злоумышленник маршрутизирует вызов к жертве, подменяя номер, дабы абонент А видел, что он звонил жертве. В итого получается что-то наподобе конференции, где третий лишний. Причём злоумышленник в любой момент может прервать разговор.</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">Перехват сообщений:</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">1) Выбирается телефонный номер жертвы.</p>
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">2) Собираем информацию об операторе. {Отправляется sendRoutingInfoForSM как при нахождении местоположения жертвы}</p>
<p style="-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><br /></p></body></html>